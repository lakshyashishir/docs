---
title: Local Development
description: Guide for setting up and running the AgentTest backend locally for development and contributions.
---

# Local Development

This guide provides information for developers working on the AgentTest backend itself or integrating deeply with it.

## Initial Setup

If you haven't already, please follow the [Installation & Setup](/getting-started/installation-setup) guide to get your local environment configured. This includes:

1.  Cloning the repository.
2.  Setting up the `.env` file with your `DATABASE_URL` and `API_KEY`.
3.  Installing `npm` dependencies.
4.  Running database migrations using `npx drizzle-kit push`.
5.  Starting the development server with `npm run dev`.

## Project Structure

The AgentTest backend is a TypeScript application built with Express.js. Here's a brief overview of the key directories and files:

*   `index.ts`: The main entry point for the Express application. It sets up middleware, routes, and starts the server.
*   `schema/schema.ts`: Defines the database schema using Drizzle ORM. This is where tables like `experiments`, `variants`, and `results` are defined.
*   `routes/`: Contains the route handlers for the API endpoints.
    *   `experiments.ts`: Handles logic for the `/experiment/:slug/assign` endpoint.
    *   `results.ts`: Handles logic for the `/experiment/:slug/log` endpoint.
*   `middleware/auth.ts`: Implements the API key authentication middleware.
*   `utils/logger.ts`: A simple console logger utility.
*   `drizzle.config.ts`: Configuration file for the Drizzle ORM CLI.
*   `tsconfig.json`: TypeScript compiler options.
*   `.env`: Environment variables (gitignored).

## Tech Stack

The backend leverages the following technologies:

| Component           | Tool                                |
| ------------------- | ----------------------------------- |
| Server              | Express.js (with TypeScript)        |
| Database            | Supabase (PostgreSQL)               |
| ORM                 | Drizzle ORM                         |
| Auth                | API Key middleware                  |
| Logging             | Custom Logger (console-based)       |
| Schema              | Drizzle schema with UUIDs and JSONB |
| Hosting (Suggested) | Railway, Fly.io, or Vercel Edge     |

## Key Developer Notes

Keep these points in mind when working with or extending the AgentTest backend:

*   **Stateless Backend**: The backend is designed to be stateless. All data required for assignments and logging is stored in and retrieved from the database (Supabase/Postgres). This simplifies scaling and deployment.
*   **Flexible Variant Payloads**: Variants can store any valid JSON as their `payload`. This allows you to A/B test anything from simple prompt strings to complex configuration objects or even identifiers for different AI agent versions.
*   **Gradual Rollout**: The `trafficPercent` attribute on variants allows for gradual rollouts of new features or prompts. You can start by exposing a new variant to a small percentage of users and gradually increase it as you gain confidence.
*   **Extendability**: The platform is designed to be extendable. You can easily:
    *   Add more complex metric tracking to the logging endpoint.
    *   Integrate with tracing systems (OpenTelemetry support is planned).
    *   Add webhooks for important events like new assignments or log entries.

Contributions and suggestions for improving the backend are welcome!
